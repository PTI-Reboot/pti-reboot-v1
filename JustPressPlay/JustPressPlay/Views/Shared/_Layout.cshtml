
@{
	// Grabs the user information for use in the top bar
	JustPressPlay.ViewModels.LayoutViewModel userInfo = JustPressPlay.ViewModels.LayoutViewModel.Populate();
}

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width" />

        <title>@ViewBag.Title - My ASP.NET MVC Application</title>

        <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
        


        @Styles.Render("~/Content/css")
        <link href="@Url.Content("~/Content/css/foundation.min.css")" type="text/css" rel="stylesheet" />
        <link href="@Url.Content("~/Content/css/jppstyle.min.css")" type="text/css" rel="stylesheet" />

        
        @Scripts.Render("~/bundles/modernizr")
            
    </head>
    <body>


        <div id="navigation" class="contain-to-grid fixed">
            <nav class="top-bar">
                <ul class="title-area">
                    <!-- Title Area -->
                    <li class="name">
                        <h1><a href="@Url.Action("Index", "Home")"><img src="@Url.Content("~/Content/Images/Jpp/logo.png")" style="margin-top: -5px;" /></a></h1>
                    </li>
                    <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
                    <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
                </ul>

                <section class="top-bar-section">

                    @if( WebSecurity.IsAuthenticated )
					{
                        <!-- Left Nav Section -->
                        <ul class="left">
                            <li class="divider hide-for-medium-up"></li>
                            <li>@Html.ActionLink("Quests", "Index", "Quests")</li>
                            <li class="divider hide-for-medium-up"></li>
                            <li>@Html.ActionLink("Achievements", "Index", "Achievements")</li>
                            <li class="divider hide-for-medium-up"></li>
                            <li>@Html.ActionLink("People", "Index", "Players")</li>
                            <li class="divider hide-for-medium-up"></li>
                        </ul>

                        <!-- Right Nav Section -->
                        <ul class="right">
                            <li>@Html.ActionLink(WebSecurity.CurrentUserName, "Profile", "Players", new { id = WebSecurity.CurrentUserId }, null)</li>
                            <li class="divider hide-for-medium-up"></li>
                            <li><a href="#" data-dropdownid="qrcodeDrop"><div aria-hidden="true" class="jppico-qrcode"></div><span class="hide-for-medium-up">PlayPass</span></a></li>
                            <li class="divider hide-for-medium-up"></li>
                            <li><a href="#" data-dropdownid="notificationDrop"><div aria-hidden="true" class="jppico-bullhorn"></div><span class="hide-for-medium-up">Notifications</span></a></li>
                            <li class="divider hide-for-medium-up"></li>
                            <li><a href="#" data-dropdownid="settingsDrop"><div aria-hidden="true" class="jppico-cog"></div><span class="hide-for-medium-up">Settings</span></a></li>
                        </ul>

                        <div id="qrcodeDrop" class="dropdownContainer">
                            <div class="title">
                                <p>PlayPass</p>
                            </div>

                            <div class="content">
                                <div id="qrcodeCanvas"></div>
                            </div>
                    
                        </div>

                        <div id="notificationDrop" class="dropdownContainer">
                            <div class="title">
                                <p>Inbox (0)</p>
                            </div>

                            <div class="content dropdownScroll">
								@if( userInfo != null && userInfo.Notifications != null )
								{
									foreach (JustPressPlay.ViewModels.LayoutNotification notify in userInfo.Notifications)
									{
										if (notify.Ignored) { continue; }
										
										<a class="item" href="#">
											<div class="itemPhoto">
												@if( String.IsNullOrWhiteSpace(notify.Icon) )
												{
													<img src="images/people/1.png" /> <!-- Default image here? -->
												}
												else
												{
													<img src="@Url.Content(notify.Icon)" />
												}
											</div>
											<div class="itemText">
												<p>
													@Html.Raw(notify.Message.Replace("[", "<span>").Replace("]", "</span>"))
													@if (notify.Type == JustPressPlay.ViewModels.LayoutNotification.NotificationType.FriendRequest)
													{
														<input type="button" value="Accept/Decline/Ignore" />
													}
												</p>
											</div>
										</a>
									}
								}

                                <a class="item" href="#">
                                    <div class="itemPhoto">
                                        <img src="images/people/1.png" />
                                    </div>
                                    <div class="itemText">
                                        <p><span>Warlock</span> accepted your friend request.</p>
                                    </div>
                                </a>

                                <a class="item" href="#">
                                    <div class="itemPhoto">
                                        <img src="images/achievements/18.png" />
                                    </div>
                                    <div class="itemText">
                                        <p>You earned the achievement <span>For the Lawls</span>.</p>
                                    </div>
                                </a>
                        
                                <a class="item" href="#">
                                    <div class="itemPhoto">
                                        <img src="images/quests/5.png" />
                                    </div>
                                    <div class="itemText">
                                        <p>You earned the quest <span>Let's Get This Party Started</span>.</p>
                                    </div>
                                </a>

                                <a class="item" href="#">
                                    <div class="itemPhoto">
                                        <img src="images/people/0.png" />
                                    </div>
                                    <div class="itemText">
                                        <p><span>Ben Snyder</span> accepted your friend request.</p>
                                    </div>
                                </a>

                                <a class="item" href="#">
                                    <div class="itemPhoto">
                                        <img src="images/people/1.png" />
                                    </div>
                                    <div class="itemText">
                                        <p><span>Warlock</span> accepted your friend request.</p>
                                    </div>
                                </a>

                                <a class="item" href="#">
                                    <div class="itemPhoto">
                                        <img src="images/achievements/18.png" />
                                    </div>
                                    <div class="itemText">
                                        <p>You earned the achievement <span>For the Lawls</span>.</p>
                                    </div>
                                </a>
                        
                                <a class="item" href="#">
                                    <div class="itemPhoto">
                                        <img src="images/quests/5.png" />
                                    </div>
                                    <div class="itemText">
                                        <p>You earned the quest <span>Let's Get This Party Started</span>.</p>
                                    </div>
                                </a>

                                <a class="item" href="#">
                                    <div class="itemPhoto">
                                        <img src="images/people/0.png" />
                                    </div>
                                    <div class="itemText">
                                        <p><span>Ben Snyder</span> accepted your friend request.</p>
                                    </div>
                                </a>
                            </div>
                    
                        </div>

                        <div id="settingsDrop" class="dropdownContainer">
                            <div class="title">
                                <p>Settings</p>
                            </div>
                            <div class="content">
                                <a class="item" href="#">
                                    <div class="itemText">
                                        <p>Account Settings</p>
                                    </div>
                                </a>

                                @if (Roles.GetRolesForUser().Length > 0)
								{
                                    
                                    <a class="item" href="@Url.Action("Index", "Admin")">
                                        <div class="itemText">
                                            <p>Admin Panel</p>
                                        </div>
                                    </a>
								}

                                <a class="item" href="javascript:document.getElementById('logoutForm').submit()">
                                    <div class="itemText">
                                        <p>Logout</p>
                                    </div>
								</a>

                                @using (Html.BeginForm("Logout", "Players", FormMethod.Post, new { id = "logoutForm" }))
								{
									@Html.AntiForgeryToken()
									
								}

                            </div>
                        </div>

					}
					else
					{
                        <ul class="right">
                            <li>@Html.ActionLink("JPP Register", "Register", "Players", routeValues: null, htmlAttributes: new { id = "registerLink" })</li>
							<li>@Html.ActionLink("JPP Login", "Login", "Players", routeValues: null, htmlAttributes: new { id = "loginLink" })</li>
                        </ul>
					}
                        
                </section>
            </nav>
        </div>


        <!--
        <header>
            <div class="content-wrapper">
                <div class="float-left">
                    <p class="site-title">@Html.ActionLink("Just Press Play", "Index", "Home")</p>
                </div>
                <div class="float-right">
					@if (WebSecurity.IsAuthenticated)
	 {
						<nav>
							<ul id="menu">
								<li>@Html.ActionLink("Quests", "Index", "Quests")</li>
								<li>@Html.ActionLink("Achievements", "Index", "Achievements")</li>
								<li>@Html.ActionLink("People", "Index", "Players")</li>
								<li>|</li>
								@if (Roles.GetRolesForUser().Length > 0)
		{
									<li>@Html.ActionLink("Admin", "Index", "Admin")</li>
									<li>|</li>
		}
								<li>@Html.ActionLink(WebSecurity.CurrentUserName, "Profile", "Players", new { id = WebSecurity.CurrentUserId }, null)</li>
								<li>
									@using (Html.BeginForm("Logout", "Players", FormMethod.Post, new { id = "logoutForm" }))
		 {
										@Html.AntiForgeryToken()
										<a href="javascript:document.getElementById('logoutForm').submit()">Logout</a>
		 }
								</li>
							</ul>
						</nav>
	 }
	 else
	 {
						<section id="login">
							<ul>
								<li>@Html.ActionLink("JPP Register", "Register", "Players", routeValues: null, htmlAttributes: new { id = "registerLink" })</li>
								<li>@Html.ActionLink("JPP Login", "Login", "Players", routeValues: null, htmlAttributes: new { id = "loginLink" })</li>
							</ul>
						</section>
	 }
                </div>
            </div>
        </header>
        -->

        <!--
        <div id="body">
            @RenderSection("featured", required: false)
            <section class="content-wrapper main-content clear-fix">
                
            </section>
        </div>
            -->

        @RenderBody()

        <footer>
            <div class="content-wrapper">
                <div class="float-left">
                    <p>&copy; @DateTime.Now.Year - My ASP.NET MVC Application</p>
                </div>
            </div>
        </footer>

        <!--@Scripts.Render("~/bundles/jquery")-->
        <script src="@Url.Content("~/Content/js/vendor/jquery2.0.2.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/js/plugin/fastclick.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/js/plugin/jquery.slimscroll.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/js/plugin/select2.min.js")" type="text/javascript"></script>
        <script src="@Url.Content("~/Content/js/plugin/qrcode.js")" type="text/javascript"></script>
        <!--<script src="@Url.Content("~/Content/js/plugin/jquery.qrcode.min.js")" type="text/javascript"></script>-->
        <script src="@Url.Content("~/Content/js/jscripts.js")" type="text/javascript"></script>
        
        <script src="@Url.Content("~/Content/js/foundation/foundation.min.js")" type="text/javascript"></script>

        <script>
            $(document).foundation();
        </script>

        <script>
            
            //$('#qrcodeCanvas').qrcode({
                //text: "http://play.rit.edu/Players/" + @WebSecurity.CurrentUserId
            //});

            var url = "http://play.rit.edu/Players/" + @WebSecurity.CurrentUserId;

            $('#qrcodeCanvas').html( create_qrcode( url ) );
            
        </script>

        @RenderSection("scripts", required: false)
    </body>
</html>
